import { Injectable } from '@angular/core';
import { HttpResponse } from '@angular/common/http';
import { Observable, of } from 'rxjs';
import { Pagination } from 'app/core/request/request.model';
import { map } from 'rxjs/operators';
import { I<%= entityClass %> } from 'app/entities/<%= entityFileName %>/<%= entityFileName %>.model';
import { GraphQLUtils } from 'app/core/util/graphql-util.service';
import { Create<%= entityClass %>Args, Create<%= entityClass %>GQL, Get<%= entityClass %>sGQL, Get<%= entityClass %>GQL, Delete<%= entityClass %>GQL, Update<%= entityClass %>Args, Update<%= entityClass %>GQL } from '../../../../graphql';

export type EntityResponseType = HttpResponse<I<%= entityClass %>>;
export type EntityArrayResponseType = HttpResponse<I<%= entityClass %>[]>;

@Injectable({ providedIn: 'root' })
export class <%= entityClass %>GraphQLService {

  constructor(private graphQLUtils: GraphQLUtils,
              private create<%= entityClass %>GQL: Create<%= entityClass %>GQL,
              private update<%= entityClass %>GQL: Update<%= entityClass %>GQL,
              private get<%= entityClass %>sGQL: Get<%= entityClass %>sGQL,
              private get<%= entityClass %>GQL: Get<%= entityClass %>GQL,
              private delete<%= entityClass %>GQL: Delete<%= entityClass %>GQL) {}

  query(req?: Pagination): Observable<EntityArrayResponseType> {
    return this.get<%= entityClass %>sGQL.fetch(this.graphQLUtils.createGraphQlOption(req)).pipe(
      map(result => this.graphQLUtils.toPagedHttpResponse(result.data.result)));
  }

  create(<%= entityInstance %>: I<%= entityClass %>): Observable<EntityResponseType> {
    return this.create<%= entityClass %>GQL
        .mutate({<%= entityInstance %>: <%= entityInstance %> as Create<%= entityClass %>Args})
        .pipe(map(result => this.graphQLUtils.toHttpResponse(result)));
  }

  delete(id: number): Observable<HttpResponse<{}>> {
    return this.delete<%= entityClass %>GQL.mutate({id}).pipe(map(result => this.graphQLUtils.toHttpResponse(result)));
  }

  find(id: number): Observable<EntityResponseType> {
    return this.get<%= entityClass %>GQL.fetch({ id }).pipe(map(result => this.graphQLUtils.toHttpResponse(result)));
  }

  partialUpdate(<%= entityInstance %>: I<%= entityClass %>): Observable<EntityResponseType> {
    return of(new HttpResponse());
  }

  update(<%= entityInstance %>: I<%= entityClass %>): Observable<EntityResponseType> {
    return this.update<%= entityClass %>GQL
        .mutate({<%= entityInstance %>: <%= entityInstance %> as Update<%= entityClass %>Args})
        .pipe(map(result => this.graphQLUtils.toHttpResponse(result)));
  }
}
